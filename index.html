<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>YoloLA</title>
    <link rel="stylesheet" type="text/css" href="src/css/reset.css"/>
    <link rel="stylesheet" href="src/css/topcoat-desktop-dark.css">
    <link rel="stylesheet" href="src/css/jquery-ui.css">
    <link rel="stylesheet" href="src/css/custom.css">
  </head>
  <body>

    <div class="left-panel">
        <div class="logo"> <img src="src/img/select.svg"/> <span>YoloLA</span></div>
        <div class="tool-bar">
            <button class="topcoat-button" style="margin: 7px; width: calc(100% - 14px); cursor: pointer;" id="btn-load-img">Load Images [png/jpg]</button>
            <hr>
            <h4><span class="percentageForValidation-show">20%</span> for validation</h4>
            <input type="range" class="topcoat-range" min="0" max="50" value="20" style="margin-left: 10px; margin-top: 6px; width: calc(100% - 20px);" id="train-validation-percentage">        
        </div>
        <div class="panel_filelist">
        </div>
        <div class="save-box">
            <button class="topcoat-button--cta" style="margin: 7px; width: calc(100% - 14px); cursor: pointer;">Export</button>
        </div>
    </div>

    <div class="right-panel">
        <div class="image-viewer">
            <img src=""/>
            <div id="x-line"></div>
            <div id="y-line"></div>
        </div>
    </div>


    <input id="input_load-img" type="file" multiple="multiple" accept="image/jpeg, image/png" style="display: none;" />


    <!-- Insert this line above script imports  -->
    <script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>
    <script>
      require('./renderer.js')
    </script>
    <script src="src/js/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script>if (window.module) module = window.module;</script>
    <script type="text/javascript">
      $(function() {

        // RESIZE LEFT PANEL
        $(".left-panel").resizable();
        // RESIZE RIGHT PANEL
        $(window).bind('resize', function(e) {
            let body_width = $(document).width();
            let this_width = $('.left-panel').width();

            $('.right-panel').css({'width':body_width - this_width + 'px'})




            let viewer_height = $('.image-viewer').height();
            let viewer_width = $('.image-viewer').width();

            //$('.image-viewer img').css({'max-height':viewer_height + 'px', 'max-width':viewer_width + 'px'})

            var maxWidth = viewer_width; // Max width for the image
            var maxHeight = viewer_height;    // Max height for the image
            var ratio = 0;  // Used for aspect ratio
            var width = $(this).width();    // Current image width
            var height = $(this).height();  // Current image height

            // Check if the current width is larger than the max
            if(width > maxWidth){
                ratio = maxWidth / width;   // get ratio for scaling image
                $(this).css("width", maxWidth); // Set new width
                $(this).css("height", height * ratio);  // Scale height based on ratio
                height = height * ratio;    // Reset height to match scaled image
                width = width * ratio;    // Reset width to match scaled image
                console.log('1');
            }

            // Check if current height is larger than max
            if(height > maxHeight){
                ratio = maxHeight / height; // get ratio for scaling image
                $(this).css("height", maxHeight);   // Set new height
                $(this).css("width", width * ratio);    // Scale width based on ratio
                width = width * ratio;    // Reset width to match scaled image
                console.log('2');
            }


        });

        // SHOW CROSSHAIR
        $(".image-viewer").mousemove(function(e) {

            var parentOffset = $(this).parent().offset();
            var mx = e.pageX - parentOffset.left;
            var my = e.pageY - parentOffset.top;
            
            $('#x-line').css({'top':my+'px'});
            $('#y-line').css({'left':mx+'px'});

        });

      });
    </script>
  </body>
</html>
